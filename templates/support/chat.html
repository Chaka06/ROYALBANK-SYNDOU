{% extends 'base.html' %}
{% block content %}
<div class="mb-4">
  <h1 class="fw-bold mb-2">
    <i class="bi bi-chat-dots me-2"></i>Support client
  </h1>
  <p class="text-muted">Communiquez directement avec notre équipe</p>
</div>

<div class="chat-container">
  <div class="chat-messages">
    {% for m in messages %}
      <div class="message {% if m.sender == 'user' %}message-user{% else %}message-admin{% endif %}">
        <div class="d-flex align-items-start mb-2">
          <div class="me-2">
            {% if m.sender == 'user' %}
              <i class="bi bi-person-circle" style="font-size: 1.5rem;"></i>
            {% else %}
              <i class="bi bi-headset" style="font-size: 1.5rem;"></i>
            {% endif %}
          </div>
          <div class="flex-grow-1">
            <div class="d-flex justify-content-between align-items-center mb-1">
              <strong>
                {% if m.sender == 'user' %}
                  Vous
                {% else %}
                  Support ROYAL
                {% endif %}
              </strong>
              <small class="opacity-75">
                <i class="bi bi-clock me-1"></i>{{ m.created_at|date:'d/m/Y H:i' }}
              </small>
            </div>
            <div>{{ m.content }}</div>
          </div>
        </div>
      </div>
    {% empty %}
      <div class="text-center text-muted py-5">
        <i class="bi bi-chat-left-text" style="font-size: 3rem; opacity: 0.3;"></i>
        <div class="mt-3">Aucun message. Démarrez la conversation !</div>
      </div>
    {% endfor %}
  </div>
  <form method="post" class="mt-3">
    {% csrf_token %}
    <div class="input-group">
      <input name="message" class="form-control form-control-lg" placeholder="Tapez votre message..." required autofocus>
      <button class="btn btn-primary btn-lg" type="submit">
        <i class="bi bi-send me-2"></i>Envoyer
      </button>
    </div>
  </form>
</div>
{% endblock %}
